---
title: "len dist"
author: "RH"
date: "4/6/2021"
output: html_document
---

```{r}
knitr::opts_chunk$set(message = FALSE,warning = FALSE)
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(tidy=TRUE)
knitr::opts_chunk$set(tidy.opts=list(width.cutoff=70))
knitr::opts_chunk$set(fig.height=4, fig.width=6)
```


```{r}
library(data.table)
  library(tidyverse)
  library(ggplot2)
  library(plotly)
  library(listviewer)
  library(gapminder)
library(ggvis)
library(corrplot)
library  (dplyr)
library(RColorBrewer)
library(DataExplorer)
library(grid)
library(gridExtra)
library(boot)
library(haven)
library(cowplot)
```


```{r}
getwd()
```


```{r}

hack = c(19, 3443 ,  1, 397844 ,  20, 2450 ,  2, 1472253 ,  21, 1905 ,  3, 1607785 ,  4, 1632703 ,  5, 962585 ,  6, 730436 ,  7, 642984 ,  8, 440245 ,  9, 309700 ,  10, 224675 ,  11, 134612 ,  12, 71936 ,  13, 46477 ,  14, 25604 ,  15, 15719 ,  16, 9763 ,  17, 6850 ,  18, 4953)

hackNS = c(19, 2228 ,  1, 15493 ,  20, 1655 ,  2, 216441 ,  21, 1309 ,  3, 603865 ,  4, 836510 ,  5, 493909 ,  6, 405346 ,  7, 389031 ,  8, 251078 ,  9, 161508 ,  10, 130504 ,  11, 73056 ,  12, 38136 ,  13, 27041 ,  14, 13648 ,  15, 9525 ,  16, 6054 ,  17, 4344 ,  18, 3052)

blog = c(1, 1224417 ,  2, 3347233 ,  3, 3767800 ,  4, 3966020 ,  5, 2204946 ,  6, 1448433 ,  7, 1326169 ,  8, 690329 ,  9, 423928 ,  10, 238191 ,  11, 128719 ,  12, 69099 ,  13, 40482 ,  14, 19988 ,  15, 12368 ,  16, 8151 ,  17, 4929 ,  18, 3297 ,  19, 2640 ,  20, 2171 ,  21, 1524)

blogNS = c(1, 78141 ,  2, 559214 ,  3, 1525925 ,  4, 2413236 ,  5, 1187590 ,  6, 844497 ,  7, 873323 ,  8, 390576 ,  9, 224348 ,  10, 139560 ,  11, 68731 ,  12, 39924 ,  13, 23734 ,  14, 10964 ,  15, 7679 ,  16, 5094 ,  17, 3069 ,  18, 2028 ,  19, 1604 ,  20, 1385 ,  21, 1002)

letter = c( 2, 14907 ,  6, 7847 ,  4, 14495 ,  8, 4348 ,  12, 687 ,  10, 2196 ,  14, 157 ,  18, 8 ,  16, 31 ,  28, 1 ,  22, 2 ,  3, 19188 ,  7, 5814 ,  9, 3238 ,  5, 9625 ,  15, 63 ,  11, 1284 ,  1, 2647 ,  13, 388 ,  17, 12 ,  19, 3 ,20,0,  21, 2 )
letterNS =   c(2,6351 ,  6, 9704 ,  4, 21116 ,  12, 782 ,  10, 2455 ,  8, 5625 ,  14, 190 ,  16, 31 ,  18, 7 ,  20, 2 ,    7, 9566 ,  9, 3966 ,  5, 14078 ,  3, 16197 ,  15, 108 ,  1, 53 ,  11, 1403 ,  13, 473 ,  17, 19 ,  19, 4 ,  27, 1 ,  21, 2 )

pride = c( 2, 35485,  8, 10405,  6, 16969,  4, 40329,  12, 142,  10, 418,  14, 3,  16, 54,  18, 15,  22, 3,  26, 2,  20, 5,  3, 48923,  7, 14764,  9, 7210,  5, 25580 ,  15, 175 ,  1, 6729 ,  11, 2427 ,  13, 764 ,  17, 28,  19, 9,  27, 1,  21, 2)

prideNS = c( 2, 6351 ,  6, 9704 ,  4, 21116 ,  12, 782 ,  10, 2455 ,  8, 5625 ,  14, 190 ,  16, 31 ,  18, 7 ,  20, 2 ,  22, 2 ,  7, 9566 ,  9, 3966 ,  5, 14078 ,  3, 16197 ,  15, 108 ,  1, 53 ,  11, 1403 ,  13, 473 ,  17, 19 ,  19, 4 ,  27, 1 ,  21, 2 
)
    

moby = c( 2, 35485 ,  8, 10405 ,  6, 16969 ,  4, 40329 ,  12, 1427 ,  10, 4187 ,  14, 319 ,  16, 54 ,  18, 15 ,  22, 3 ,  26, 2 ,  20, 5 ,  3, 48923 ,  7, 14764 ,  9, 7210 ,  5, 25580 ,  15, 175 ,  1, 6729 ,  11, 2427 ,  13, 764 ,  17, 28 ,  19, 9 ,  27, 1 ,  21, 2)

mobyNS = c( 2, 6351 ,  6, 9704 ,  4, 21116 ,  12, 782 ,  10, 2455 ,  8, 5625 ,  14, 190 ,  16, 31 ,  18, 7 ,  20, 2 ,  22, 2 ,  7, 9566 ,  9, 3966 ,  5, 14078 ,  3, 16197 ,  15, 108 ,  1, 53 ,  11, 1403 ,  13, 473 ,  17, 19 ,  19, 4 ,  27, 1 ,  21, 2 )

sherlock = c(10, 1586 ,  2, 20350 ,  8, 4165 ,  6, 8518 ,  4, 20681 ,  12, 444 ,  14, 82 ,  16, 8 ,  18, 4 ,  22, 2 ,  7, 6385 ,  3, 24486 ,  5, 11326 ,  9, 2635 ,  15, 27 ,  1, 5756 ,  17, 8 ,  11, 856 ,  13, 224 ,  19, 1 ,  20,0 ,  21, 2)

sherlockNS = c( 10, 879 ,  6, 5361 ,  2, 4108 ,  4, 11727 ,  12, 228 ,  8, 2275 ,  14, 58 ,  16, 4 ,  18, 2 ,  22, 2 ,  7, 3983 ,  5, 6564 ,  3, 9073 ,  9, 1462 ,  15, 17 ,  1, 75 ,  11, 515 ,  13, 137 ,  17, 4 ,  19, 1 ,20,0,  21, 2 )

frank = c(  2, 14276 ,  12, 491 ,  4, 12048 ,  14, 72 ,  6, 6501 ,  8, 3792 ,  10, 1778 ,  18, 4  ,  16, 9 ,  3, 16739 ,  7, 5585 ,  9, 3285 ,  5, 7907 ,  15, 33 ,  11, 1065 ,  1, 4349 ,  13, 167 ,  19, 1 ,  20,0,   21, 2 ,17,0
)
frankNS = c( 12, 292 ,  2, 2059 ,  14, 41 ,  6, 3954 ,  4, 6657 ,  10, 915 ,  8, 2039 ,  18, 2 ,  16, 4 ,  22, 2 ,  7, 3446 ,  9, 1846 ,  5, 4787 ,  3, 5857 ,  15, 24 ,  11, 591 ,  1, 39 ,  13, 95 ,  23, 1 ,  21, 2,17,0,19,0,20,0  )

gg = c(2, 8405 ,  6, 4367 ,  10, 914 ,  4, 9475 ,  8, 2023 ,  12, 275 ,  18, 3 ,  14, 59 ,  16, 19 ,  24, 1 ,  20, 1 ,  22, 2 ,  3, 11724 ,  7, 3272 ,  9, 1558 ,  5, 5671 ,  1, 2684 ,  15, 27 ,  13, 140 ,  11, 517 ,  17, 7 ,  19, 2 ,  21, 2 )
ggNS = c ( 6, 2573 ,  2, 1763 ,  10, 519 ,  4, 5516 ,  12, 142 ,  8, 1054 ,  18, 2 ,  14, 35 ,  16, 11 ,  24, 1 ,  22, 2 ,  7, 2104 ,  9, 831 ,  5, 2936 ,  1, 40 ,  3, 4374 ,  15, 15 ,  11, 275 ,  13, 74 ,  19, 1 ,  17, 3 ,  21, 2,20,0 )

cities = c( 2, 25179 ,  4, 25343 ,  6, 11020 ,  8, 6207 ,  12, 715 ,  10, 2330 ,  14, 139 ,  16, 25 ,  18, 10 ,  22, 5 ,  20, 2 ,  3, 33414 ,  7, 9189 ,  9, 3891 ,  5, 14830 ,  1, 4965 ,  15, 72 ,  13, 358 ,  11, 1279 ,  19, 3 ,  17, 8 ,  21, 2)
citiesNS = c( 6, 6586 ,  2, 4594 ,  4, 14179 ,  12, 383 ,  10, 1349 ,  8, 3446 ,  14, 91 ,  16, 12 ,  18, 8 ,  22, 5 ,  20, 1 ,  7, 5616 ,  9, 2233 ,  5, 8529 ,  3, 12535 ,  15, 42 ,  13, 246 ,  11, 642 ,  1, 28 ,  19, 2 ,  17, 6 ,  21, 2 
              )
```




```{r}

conv = function(df){
df = as.data.frame(df)
df =do.call("cbind", split(df, rep(c(1, 2), length.out = nrow(df))))
colnames(df) <- c("number", "count")
df = df[order(df$number),]
}
```

```{r}
hdf = conv(hack)
hNSdf = conv(hackNS)
hdf = filter(hdf, number < 22)
hNSdf = filter(hNSdf, number < 22)
```

```{r}
bdf = conv(blog)
bNSdf = conv(blog)
bdf = filter(hdf, number < 22)
bNSdf = filter(hNSdf, number < 22)
```
```{r}
cdf = conv(cities)
cNSdf = conv(citiesNS)
cdf = filter(cdf, number < 22)
cNSdf = filter(cNSdf, number < 22)
```



```{r}
mdf = conv(moby)
mNSdf = conv(mobyNS)

mdf = filter(mdf, number < 22)
mNSdf = filter(mNSdf, number < 22)
```


```{r}
ggdf = conv(gg)

ggNSdf = conv(ggNS)
ggdf = filter(ggdf, number < 22)
ggNSdf = filter(ggNSdf, number < 22)

```

```{r}
fdf = conv(frank)

fNSdf = conv(frankNS)
fdf = filter(fdf, number < 22)
fNSdf = filter(fNSdf, number < 22)
```

```{r}
sdf = conv(sherlock)

sNSdf = conv(sherlockNS)
sdf = filter(sdf, number < 22)
sNSdf = filter(sNSdf, number < 22)
```

```{r}
pdf = conv(pride)

pNSdf = conv(prideNS)
pdf = filter(pdf, number < 22)
pNSdf = filter(pNSdf, number < 22)
```

```{r}
ldf = conv(letter)

lNSdf = conv(letterNS)
ldf = filter(ldf, number < 22)
lNSdf = filter(lNSdf, number < 22)
```


trial
```{r}
d = mdf
s = sum(d$count)

d = d %>% mutate( percentage =  round(count/s*100, digits = 0) )


p = ggplot(data = d, aes(x=number,y=percentage, fill = percentage) ) +
geom_col() +
  labs(title = "Distribution of Word Lengths - Moby Dick",
       subtitle = '',
       y = 'Count',
        x = 'Word Length')+
  guides(fill=FALSE) + 
  theme(plot.title = element_text(hjust = 0.5)) +
theme_classic() +
  theme(axis.text.x=element_text(angle=45, hjust=1))
p

```
trial
```{r}
d = mNSdf
s = sum(d$count)

d = d %>% mutate( percentage =  round(count/s*100, digits = 0) )


p = ggplot(data = d, aes(x=number,y=percentage, fill = percentage) ) +
geom_col() +
  labs(title = "Distribution of Word Lengths - Moby Dick",
       subtitle = 'No Stop Words',
       y = 'Count',
        x = 'Word Length')+
  guides(fill=FALSE) + 
  theme(plot.title = element_text(hjust = 0.5)) +
theme_classic() +
  theme(axis.text.x=element_text(angle=45, hjust=1))
p

```








```{r}

totcount =  cdf$count + fdf$count + ldf$count   + sdf$count + ggdf$count + pdf$count  + mdf$count

sumtot = sum(totcount)
p=totcount/sumtot*100
p = round(p)

d = d%>% mutate(totpercentage = p)

```

```{r}


p = ggplot(data = d, aes(x=number,y=totpercentage, fill = totpercentage) ) +
geom_col() +
  labs(title = "Distribution of Word Lengths - Classics",
       subtitle = '',
       y = 'Percentage',
        x = 'Word Length')+
  guides(fill=FALSE) + 
  theme(plot.title = element_text(hjust = 0.5)) +
theme_classic() +
  theme(axis.text.x=element_text(angle=45, hjust=1))
p
dev.copy(png,'C_dist.png')
dev.off

```


```{r}

totcount =  cNSdf$count + fNSdf$count + lNSdf$count   + sNSdf$count + ggNSdf$count + pNSdf$count  + mNSdf$count

sumtot = sum(totcount)
p=totcount/sumtot*100
p = round(p)


d = d %>% mutate(totpercentageNS = p)


```

```{r}


p = ggplot(data = d, aes(x=number,y=totpercentage, fill = totpercentage) ) +
geom_col() +
  labs(title = "Distribution of Word Lengths - Classics",
       subtitle = 'No Stop Words',
       y = 'Percentage',
        x = 'Word Length')+
  guides(fill=FALSE) + 
  theme(plot.title = element_text(hjust = 0.5)) +
theme_classic() +
  theme(axis.text.x=element_text(angle=45, hjust=1))
p
dev.copy(png,'C_dist.NS.png')
dev.off

```
mod
```{r}

totcount =  hdf$count + bdf$count 

sumtot = sum(totcount)
p=totcount/sumtot*100
p = round(p)
#totpercentage = as.data.frame(p)



d = d %>% mutate(totpercentage = p)


```
 mod
```{r}

p = ggplot(data = d, aes(x=number,y=totpercentage, fill = totpercentage) ) +
geom_col() +
  labs(title = "Distribution of Word Lengths - Internet",
       subtitle = '',
       y = 'Percentage',
        x = 'Word Length')+
  guides(fill=FALSE) + 
  theme(plot.title = element_text(hjust = 0.5)) +
theme_classic() +
  theme(axis.text.x=element_text(angle=45, hjust=1))
p
dev.copy(png,'INT.dist.png')
dev.off
```

mod
```{r}

totcount =  hNSdf$count + bNSdf$count 

sumtot = sum(totcount)
p=totcount/sumtot*100
p = round(p)
#totpercentage = as.data.frame(p)



d =  d%>% mutate(totpercentage = p)


```
 mod
```{r}


p = ggplot(data = d, aes(x=number,y=totpercentage, fill = totpercentage) ) +
geom_col() +
  labs(title = "Distribution of Word Lengths - Internet",
       subtitle = 'No Stop Words',
       y = 'Percentage',
        x = 'Word Length')+
  guides(fill=FALSE) + 
  theme(plot.title = element_text(hjust = 0.5)) +
theme_classic() +
  theme(axis.text.x=element_text(angle=45, hjust=1))
p
dev.copy(png,'INT.dist.NS.png')
dev.off

```